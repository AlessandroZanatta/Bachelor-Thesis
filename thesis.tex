\def\thudbabelopt{english}
\PassOptionsToPackage{usenames}{xcolor}
\PassOptionsToPackage{dvipsnames}{xcolor}
\documentclass[target=bach,aauheader=]{thud}

%% --- Information about the thesis --- %%
\course{Internet of Things, Big Data and Web}
\title{Comparison of tools for the formal verification of MTProto 2.0}
\author{Alessandro Zanatta}
\supervisor{Prof.\ Marino Miculan}
\cosupervisor{Prof.\ Nicola Vitacolonna} % TODO: Is Vitacolonna considered a supervisor?
%% Other available fields: \reviewer, \tutor, \chair, \date (anno accademico, calcolato in automatico), \rights

%% --- Suggested packages ---
%% pdfx: per generare il PDF/A per l'archiviazione. Necessario solo per la versione finale
\usepackage[a-1b]{pdfx}
%% hyperref: Regola le impostazioni della creazione del PDF... più tante altre cose. Ricordarsi di usare l'opzione pdfa.
\usepackage[pdfa]{hyperref}
%% tocbibind: Inserisce nell'indice anche la lista delle figure, la bibliografia, ecc.

%% --- Stili di pagina disponibili (comando \pagestyle) ---
%% sfbig (predefinito): Apertura delle parti e dei capitoli col numero grande; titoli delle parti e dei capitoli e intestazioni di pagina in sans serif.
%% big: Come "sfbig", solo serif.
%% plain: Apertura delle parti e dei capitoli tradizionali di LaTeX; intestazioni di pagina come "big".

%% --- Other packages --- %%
\usepackage{msc} % Protocol graphical representation
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{enumitem}
\usepackage[justification=centering]{caption} % Used to have always centered captions
\usepackage{cleveref} % better references
\usepackage{graphicx} % for images
\usepackage{textgreek} % greek letters out of math mode
\usepackage{caption} % captions for equations (outside of floats, in general)
\usepackage{listings}
\usepackage[super]{nth}
\usepackage{multicol}
\usepackage[T1]{fontenc}
\usepackage{courier} % Font for listings

\newcommand\keywordstyle[1]{{\footnotesize\color{MidnightBlue}\bfseries\mathversion{bold}#1}}

\lstset{
  numbers=left,
  xleftmargin=\parindent,
  basicstyle=\small\linespread{1}\ttfamily,
  breaklines=true,
  captionpos=b,
  aboveskip=10pt,
  belowskip=10pt,
  literate=%
  {∃}{{\keywordstyle{$\exists$}}}1
  {∀}{{\keywordstyle{$\forall$}}}1
  {∧}{{\keywordstyle{$\land$}}}1
  {∨}{{\keywordstyle{$\lor$}}}1
  {¬}{{\keywordstyle{$\neg$}}}1
  {==>}{{\keywordstyle{$\Longrightarrow$}}}1
}
\graphicspath{ {./images/} } % images path

\DeclareCaptionType{equ}[][]

%% --- Commands --- %%
\newcommand\setmscoptions{
  % \setlength{\levelheight}{1.5 \levelheight}%
  % \setlength{\instwidth}{3cm}
  \setmsckeyword{}
  \drawframe{no}
  \centering
}


% Multiline comments
\newcommand{\comment}[1]{}

\newcommand*{\Z}{\mathbb{Z}}
\newcommand*{\Q}{\mathbb{Q}}

%% Taken from https://hal.inria.fr/file/index/docid/955869/filename/sapic.tex
\newcommand{\msrewrite}[1]{\mathrel{-\hspace{-2pt}[#1]\hspace{-4pt}\to}}
\newcommand{\emptyrule}{\ensuremath{[]}\xspace}
\newcommand{\msr}[3]{\ensuremath{#1 \msrewrite{#2} #3}}
%% -------------- %%

\newcommand{\msrnolabel}[2]{\ensuremath{#1 \rightarrow #2}}
\newcommand{\msrsetminus}{\ensuremath{\setminus^\#}}
\newcommand{\msrcap}{\ensuremath{\cap^\#}}
\newcommand{\msrcup}{\ensuremath{\cup^\#}}
\newcommand{\msrin}{\ensuremath{\in^\#}}
\newcommand{\msrsubseteq}{\ensuremath{\subseteq^\#}}
\newcommand{\lin}[1]{\ensuremath{lin\left(#1\right)}}
\newcommand{\pers}[1]{\ensuremath{pers\left(#1\right)}}

\newcommand{\fact}[2]{\ensuremath{\mbox{!#1}\left(#2\right)}}
\newcommand*{\myexp}{\hat{\mkern6mu}}

% pi-calculus
\newcommand{\pic}{\textpi-calculus }
\newcommand{\picnospace}{\textpi-calculus}
\newcommand{\apicpc}[2]{\ensuremath{P\ |\ Q}}
\newcommand{\apicin}[4]{\mbox{in}\left(#1, #2: #3\right); #4}
\newcommand{\apicout}[3]{\mbox{out}\left(#1, #2\right); #3}
\newcommand{\apicrep}[1]{!#1}
\newcommand{\apicnew}[3]{\ensuremath{\mbox{new}\ #1: #2; #3}}
\newcommand{\apiclet}[5]{\ensuremath{\mbox{let}\ #1: #2\ = #3\ \mbox{in}\ #4\ \mbox{else}\ #5}}
\newcommand{\apicif}[3]{\ensuremath{\mbox{if}\ #1\ \mbox{then}\ #2\ \mbox{else}\ #3}}
\newcommand{\apicevent}[2]{\ensuremath{\mbox{event}\ \mbox{#1}\left(#2\right)}}

% MTProto encryption symbols/functions
\newcommand{\func}[2]{\ensuremath{\mbox{#1}\left(#2\right)}}
\newcommand{\enc}[2]{\ensuremath{\left\{#1\right\}_{#2}}}
\newcommand{\sha}[2]{\ensuremath{\func{sha#1}{#2}}}
\newcommand{\kdf}[1]{\ensuremath{\func{kdf}{#1}}}
\newcommand{\fpk}[1]{\ensuremath{\func{fpk}{#1}}}
\newcommand{\hash}[1]{\ensuremath{\func{hash}{#1}}}
\newcommand{\modexp}[3]{\ensuremath{#1^#2 \mod{#3}}}
\newcommand{\key}[1]{\ensuremath{k_{#1}}}
\newcommand{\newkey}[1]{\ensuremath{k'_{#1}}}
\newcommand{\group}[1]{\ensuremath{\Z_{#1}}}

% spacing in math multiline mode
\setlength{\jot}{1pt}

%% -------------------------------------------------------------------------------- %%
%% Languages listings                                                               %%
%% -------------------------------------------------------------------------------- %%
\lstdefinelanguage{tamarin}
{
  keywordstyle=\color{MidnightBlue}\bfseries,
  keywordstyle=[2]\itshape,
  keywordstyle=[3]\color{Green}\bfseries,
  keywordstyle=[4]\color{RedViolet}\bfseries,
  alsoletter={^,==>,|,&,.},
  keywords={let, in, Out, In, K, KU, Fr, ^, senc, sdec, adec, aenc, ~, All, Ex, not, ., &, |, ==>, diff},
  keywords=[2]{},
  keywords=[3]{},
  keywords=[4]{rule, lemma},
  sensitive=true,
  morecomment=[l]{//},
  morecomment=[n][\color{OliveGreen}\itshape]{/*}{*/},
  morestring=[b]',
  stringstyle=\color{BrickRed},
}

\lstdefinelanguage{verifpal}
{
  keywordstyle=\color{MidnightBlue}\bfseries,
  keywordstyle=[2]\itshape,
  keywordstyle=[3]\color{Green}\bfseries,
  keywordstyle=[4]\color{Orange}\bfseries,
  alsoletter={->, ?},
  keywords={principal, attacker, queries, ->, ?},
  keywords=[2]{Client, Server, Alice, Bob},
  keywords=[3]{leaks, phase},
  keywords=[4]{active, passive},
  sensitive=true,
  morecomment=[l]{//},
  morestring=[b]",
}

\lstdefinelanguage{proverif}
{
  keywordstyle=\color{MidnightBlue}\bfseries,
  keywordstyle=[2]\itshape,
  keywordstyle=[3]\color{Green}\bfseries,
  keywords={table, query, insert, leaks, phase, get, out, event, in, ., ;, attacker, |, new, if, else, then, !, let},
  alsoletter={., ;, |, !},
  keywords=[2]{Client, Server},
  keywords=[3]{},
  sensitive=true,
  morecomment=[l]{//},
  morecomment=[n][\color{OliveGreen}\itshape]{(*}{*)},
  morestring=[b]",
}

%% -------------------------------------------------------------------------------- %%
%% Document start                                                                   %%
%% -------------------------------------------------------------------------------- %%
\begin{document}
\maketitle

%% Dedica (opzionale)
\begin{dedication}
  Al mio cane,\par per avermi ascoltato mentre ripassavo le lezioni.
\end{dedication}

%% Ringraziamenti (opzionali)
\acknowledgements
Ringraziamenti vari qua

%% Sommario (opzionale)
\abstract
Un bell'abstract va qua!

%% Indice
\tableofcontents

%% Lista delle tabelle (se presenti)
%\listoftables

%% Lista delle figure (se presenti)
%\listoffigures

%% Corpo principale del documento
\mainmatter

%% Capitolo
\chapter{Introduction}
\input{./chapters/01_introduction}

\chapter{Symbolic and Computational model}
\input{./chapters/02_symbolic_computational}

\chapter{MTProto2.0 protocol description}
\input{./chapters/03_mtproto_informal}

\chapter{Tools comparison}
\input{./chapters/04_tools_comparison}

\chapter{Formalisation in Tamarin-Prover}
\input{./chapters/05_tamarin_formalisation}

\chapter{Comparison with Proverif}
\input{./chapters/06_comparison}

%% Fine dei capitoli normali, inizio dei capitoli-appendice (opzionali)
% \appendix

%% Parte conclusiva del documento; tipicamente per riassunto, bibliografia e/o indice analitico.
\backmatter

%% Riassunto (opzionale)
%\summary

%% Bibliografia (praticamente obbligatoria)
\bibliographystyle{plain_\languagename}
\bibliography{thud}

\end{document}